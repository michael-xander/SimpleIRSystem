Geometry for Computer Graphics
00  29/09/04  15:36  Page i
John Vince
Geometry for Computer Graphics Formulae,Examples and Proofs
123
00  29/09/04  15:36  Page iii
John Vince MTech,PhD,CEng,FBCS National Centre for Computer Animation Bournemouth University,UK
British Library Cataloguing in Publication Data Vince,John (John A.) Geometry for computer graphics :formulae,examples and proofs 1.Computer graphics 2.Geometry - Data processing I.Title 516'.0028566 ISBN 1852338342
Library of Congress Cataloging-in-Publication Data A catalog record for this book is available from the Library of Congress
Apart from any fair dealing for the purposes of research or private study,or criticism or review,as permitted under the Copyright,Designs and Patents Act 1988,this publication may only be reproduced,stored or transmitted,in any form or by any means,with the prior permission in writing of the publishers,or in the case of reprographic reproduction in accordance with the terms of licences issued by the Copyright Licensing Agency.Enquiries concerning reproduction outside those terms should be sent to the publishers.
ISBN 1-85233-834-2 Springer-Verlag London Berlin Heidelberg Springer ScienceBusiness Media springeronline.com
(c) Springer-Verlag London Limited 2005 Printed in the United States ofAmerica
The use of registered names, trademarks etc. in this publication does not imply, even in the absence of a speci?c statement,that such names are exempt from the relevant laws and regulations and therefore free for general use.
The publisher makes no representation,express or implied,with regard to the accuracy ofthe information contained in this book and cannot accept any legal responsibility or liability for any errors or omissions that may be made.
Typesetting:Gray Publishing,Tunbridge Wells,UK 34/3830-543210 Printed on acid-free paper SPIN 10981696
00  29/09/04  15:36  Page iv
Dedication This book is dedicated to my family,Annie,Samantha,Anthony,Megan,and Monty,who have not seen much of me over the past two years.
00  29/09/04  15:36  Page v
Preface
Anyone who has written programs for computer graphics,CAD,scienti?c visualization,computer games,virtual reality or computer animation will know that mathematics is extremely useful. Topics such as transformations, matrix algebra, vector algebra, curves and surfaces are at the heart ofany application program in these areas,but the one topic that is really central is geometry, which is the theme of this book. I recall many times when writing computer animation programs my own limited knowledge of geometry.I remember once having to create a 3D lattice of dodecahedrons as the basis for a cell growth model.At the time,I couldn't ?nd a book on the subject and had to compute Platonic solid dihedral angles and vertex coordinates from scratch.The Internet had not been invented and I was left to my own devices to solve the problem.As it happened,I did solve it,and my new found knowledge of Platonic objects has never waned. Fortunately,I no longer have to write computer programs,but many other people still do,and the need for geometry has not gone away.In fact,as computer performance has increased,it has become possible to solve amazingly complex three-dimensional geometric problems in real time. The reason for writing this book is threefold:to begin with,I wanted to coordinate a wealth of geometry that is spread across all sorts ofmath books and the Internet;second,I wanted to illustrate how a formula was used in practice;third,I wanted to provide simple proofs for these formulas. Personally,whenever I see an equation I want to know its origin.For example,why is the volume ofa tetrahedron one-sixth ofa set ofvertices? Where does the 'one-sixth'come from? Take another example:why is the volume of a sphere four-thirds,p,radius cubed? Where does the 'four-thirds' come from? Why isn't it '?ve-sixths'? This may be a personal problem I have about the origins of formulas but I do ?nd that my understanding ofa subject is increased when I understand its origins. Quaternions are another example.There is still some mystique about what they are and how they work. I can think of no better way of understanding quaternions than to read about Sir William Rowan Hamilton and discover how he stumbled across his now famous non-commutative algebra. I am the ?rst to admit that I am not a mathematician,and this book is not intended to be read by mathematicians.A mathematician would have approached the subject with a greater logical rigour and employed formal structures that are relevant to the world of mathematics, but of
vii
00  29/09/04  15:36  Page vii
little interest to a programmer wanting to ?nd a formula for a parametric line equation intersecting a spherical surface. For example,hyperplanes are a very powerful mathematical instrument for analyzing complex geometric scenarios,but this is not very relevant to a programmer who simply wants to know the line of intersection between two planes. Consequently, I have avoided the mathematical hierarchies used by mathematicians to compress their language into the smallest number of symbols.This is why I have avoided statements such as Hn  Rn1  {xn|xn = 0 (xn  R)},but included formulas such as:A  r2! When I started this book I had no idea ofits ?nal structure.I asked colleagues ifthey had books on geometry that I could borrow.The ?rst book I came across was Mathematics Encyclopedia edited by Max Shapiro.There I found a source of de?nitions that gave some initial breadth to the subject.I then discovered that I had in my own library The VNR Concise Encyclopedia of Mathematicsedited by Gellert,Gottwald,Hellwich,Hästner and Kuˆstner.This book helped me understand some ofthe strategies used by mathematicians to resolve some standard geometric problems. Then I discovered one of Springer's 'yellow' math books: Handbook of Mathematics and Computational Scienceby John Harris and Horst Stocker.Further 'yellow'books emerged from Springer: Geometry I by Marcel Berger, Geometry: Plane and Fancy by David Singer, and Geometry:Our Cultural Heritageby Audun Holme. One of my favourite math books is Mathematics:From the Birth of Numbersby Jan Gullberg. It is a work of art,and Gullberg's clarity of writing inspired me to make my own explanations as precise and informative as possible. It was only when I was half-way through my manuscript that I came across one of my favourite books A Programmer's Geometry by Adrian Bowyer and John Woodwark. When I opened it I realized that this is what my own book was about - a description of the geometric conditions that arise when lines,planes and spheres are brought into contact. Early in my career I had met Adrian and John when they were at the University of Bath and they had showed me their ray casting programs and animations.Geometry was obviously an important part of their work. However, although their book covers a wide range of topics, it does not show the origins of their equations,and I spent many weeks devising compact proofs to substantiate their results.Nevertheless,their book has had a great impact on this book and I openly acknowledge their in?uence. My personal library of math books is not extensive but reasonable. But there were many occasions when I had to resort to the Internet and do a Google search on topics such as 'Heron's formula', 'quaternions', 'Platonic objects', 'plane equations', etc. Such searches produced volumes ofdata but frequently the information I wanted was just not there.So over the past two years I have had no choice but to sit down and work out a solution for myself. The book's scope was a problem - where should it start,and where should it end? I decided that I would begin with some important concepts ofEuclidean plane geometry.For example,recognizing similar or congruent triangles is a very powerful problem-solving technique and provided some solid foundations for the rest ofthe book.Where to end was much more dif?cult.Some reviewers of early manuscripts suggested that I should embrace the geometric aspects of rendering,radiosity, physics,clipping,NURBS,and virtually the rest of computer graphics.I declined this advice as it would have changed the ?avor ofthe book,which is primarily about geometry.Perhaps,I should not have included Bézier curves and patches,but I was tempted to include them as they developed the ideas ofparametric formulas to control geometry.
viii Preface
00  29/09/04  15:36  Page viii
Mathematicians have still not agreed upon a common notation for their mathematical instruments,which has made my life extremely frustrating in preparing this book.For example, some math books refer to vectors as a ? whilst others employ a. The magnitude of a vector is expressed as |a ?| by one community and ||a|| by another.The scalar product is sometimes written as a ?•b ?or a•band so on. Some mathematicians use arctan in preference to tan1 as the superscript is thought to be confusing. Even plane equations have two groups of followers: those that use ax  by  cz  d  0 and others who prefer ax  by  cz  d. The difference may seem minor but one has to be very careful when applying the formulas involving these equations.But perhaps the biggest problem of all is the use of matrices as they can be used in two transposed modes.In the end,I selected what I thought was a logical notation and trust that the reader will ?nd the usage consistent. The book is designed to be used in three ways:the ?rst section provides the reader with list of formulas across a wide range ofgeometric topics and hopefully will reveal a useful solution when referenced. Where relevant, I have provided alternative formulas for different mathematical representations. For example, a 2D line equation can be expressed in its general form or parametrically,which gives rise to two different solutions to a problem.I have also shown how a formula is simpli?ed if a line equation is normalized or a normal vector has a unit length. The second section places all the equations in some sort of context. For example, how to compute the angle between two planes; how to compute the area of an irregular polygon; or how to generate a parametric sinusoidal curve. I anticipate that this section will be useful to students who are discovering some of these topics for the ?rst time. The third section is the heart ofthe book and hopefully will be useful to lecturers teaching the geometric aspects of computer graphics.Students will also ?nd this section instructive for two reasons: ?rst it will show the origins of the formula; and second, it will illustrate different strategies for solving problems.I learnt a lot deriving these proofs.I discovered how important it was to create a scenario where the scalar product could be introduced, as this frequently removed an unwanted variable and secured the value ofa parameter (often ) which determined the ?nal result.Similarly,the cosine rule was very useful as an opening problem-solving strategy. Some proofs took days to produce. There were occasions when I after several hours work I had proved that 1  1! There were occasions when a solution seemed impossible, but then after scanning several books I discovered a trick such as completing the square,or making a point on a line perpendicular to the origin. This project has taught me many lessons:the ?rst is that mathematics is nothing more than a game played according to a set of rules that keeps on growing.When the rules don't ?t,they are changed to accommodate some new mathematical instrument.Vectors and quaternions are two such examples.Another lesson is that to become good at solving mathematical problems one requires a knowledge of the 'tricks of the trade'used by mathematicians.Alas,such tricks often demand knowledge of mathematics that is only taught to mathematicians. I would like to acknowledge the advice given by my colleague Prof.Jian Zhang who offered constructive suggestions whilst preparing the manuscript.Also I would like to thank Rebecca Mowatt who provided vital editorial support throughout the entire project. Finally,I thank the authors of all the books listed in the bibliography,as they made the book possible,and last,but not least,a very big thank you to Robert Gray who typeset the book. John Vince Ringwood
